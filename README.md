# 湖北大学教务系统课表批量采集与导出
## 项目简介
本项目实现了从湖北大学教务系统自动化批量采集课表参数、筛选目标班级，并一键导出班级课表为 Excel 文件。支持单个班级交互导出和批量全部导出，所有课表自动按“专业/年级”分文件夹，统一归档在“全部课表导出”总文件夹下。
---
## 使用流程
### 1. 采集所有班级参数
运行 采集参数.py，自动遍历“理论课表-各类课表查询”页面下所有院系、年级、专业、班级，采集参数并导出为 所有的课表参数.csv。
- 需手动登录教务系统并切换到目标页面，按提示操作。
- 采集结果包含院系、年级、专业、班级、学年学期、校区等参数。
### 2. 筛选目标班级参数
运行 筛选课表参数.py，可根据年级等条件筛选出需要导出的班级参数，生成 筛选的课表参数.csv。
- 默认只保留 2025、2024、2023、2022 级。
- 可根据需要修改 `target_years` 集合。
### 3. 交互式导出单个班级课表
运行 采集课表.py，按提示依次选择院系、年级、专业、班级、学年学期、校区，自动从教务系统采集课表并导出为 Excel 文件。
- 首次运行会提示你用浏览器登录教务系统，进入课表查询界面，手动复制 cookie 中的 JSESSIONID 并粘贴输入。
- 支持多次导出不同班级课表，文件名自动命名。
### 4. 批量导出全部班级课表（推荐）
运行 批量采集课表.py，自动遍历 筛选的课表参数.csv，为每个班级批量导出课表 Excel。
- 所有导出的课表文件会统一放在“全部课表导出”总文件夹下，再按“专业/年级”分子文件夹保存。
- 采集失败的班级会自动记录到 `采集失败列表.csv`。
---
## 文件说明
- 采集参数.py：自动化采集所有班级参数，生成 所有的课表参数.csv
- 筛选课表参数.py：筛选目标班级参数，生成 筛选的课表参数.csv
- 采集课表.py：交互式导出单个班级课表为 Excel
- 批量采集课表.py：批量导出全部班级课表，自动分文件夹归档
- 所有的课表参数.csv：原始参数数据
- 筛选的课表参数.csv：筛选后的参数数据
- `全部课表导出/`：所有导出的课表 Excel 文件，按“专业/年级”分文件夹存放
- `采集失败列表.csv`：批量采集失败的班级参数
---
## 依赖环境
- Python 3.8+
- requests
- openpyxl
- beautifulsoup4
- selenium
- Chrome 浏览器及 chromedriver
安装依赖：
```bash
pip install requests openpyxl beautifulsoup4 selenium
```
---
## 注意事项
- 采集参数需手动登录，确保页面切换正确。
- 采集课表时每次都需手动输入 JSESSIONID（安全且防止失效）。
- 若遇到 KeyError、编码等问题，确保 CSV 文件为 UTF-8 编码，且字段顺序与脚本一致。
- 建议先用小范围参数测试，确认无误后再批量导出。
- 批量导出时所有文件自动归档在“全部课表导出”下，便于管理。
---
## 常见问题
- **JSESSIONID 失效**：重新登录教务系统，复制最新的 JSESSIONID。
- **采集失败/无数据**：检查参数是否正确、网络是否畅通，或稍后重试。
- **Excel 文件打不开**：确认已完整导出，或用 WPS/Excel 打开。
如有问题可随时反馈或自行修改脚本参数。
---